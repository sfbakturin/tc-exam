# Ключевое уравнение декодирования кодов БЧХ. Алгоритм Форни. Декодирование с помощью алгоритма Евклида

> Данный билет является продолжение [23](T23.md)-его. Перед прочтением этого, рекомендуется прочитать предыдущий.

По познаниям из 23-го билета мы знаем, что синдромы связаны с локаторами и значениями ошибок следующим образом:

$$
  S_i = \sum_{l = 1}^{t}{\left(E_lX_l^{b + i}\right)}, ~ 0 \leqslant i < \delta - 1
$$

Давайте компоненты вектора синдрома упакуем в многочлен:

$$
  S_i = \sum_{l = 1}^{t}{\left(E_lX_l^{b + i}\right)} \to S(x) = \sum_{l = 0}^{\delta - 2}{\left(S_ix^i\right)}
$$

Здесь, в правой части, мы снова подставляем то, что знаем про $S_i$ и группируем по степеням $x$:

$$
  \begin{aligned}
  S(x) &= \sum_{l = 0}^{\delta - 2}{\left(S_ix^i\right)} \\
  &= \sum_{l = 1}^{t}{\left(E_lX_l^b\textcolor{red}{\sum_{i = 0}^{\delta - 2}{\left(\left(X_lx\right)^i\right)}}\right)}
  \end{aligned}
$$

Теперь рассмотрим многочлен $1 - \left(X_lx\right)^{\delta - 1}$ - его можно разложить на множители следующим образом:

$$
  1 - \left(X_lx\right)^{\delta - 1} = \left(1 - X_lx\right) \left(\sum_{i = 0}^{\delta - 2}{\left(\left(X_lx\right)^i\right)}\right)
$$

А теперь приведём его по модулю $x^{\delta - 1}$: у нас была в левой части $x^{\delta - 1}$ - что будет, если взять остаток от деления на $x^{\delta - 1}$? - $1$. А это значит, что:

$$
  \left(1 - X_lx\right) \left(\sum_{i = 0}^{\delta - 2}{\left(\left(X_lx\right)^i\right)}\right) \equiv 1 \operatorname{mod} x^{\delta - 1}
$$

Продолжая преобразовывать, давайте вынесем в правую часть также всё, что не относится к сумме, то есть:

$$
  \textcolor{red}{\sum_{i = 0}^{\delta - 2}{\left(\left(X_lx\right)^i\right)}} \equiv \dfrac{1}{1 - X_lx} \operatorname{mod} x^{\delta - 1}
$$

Но ведь выделенное $\textcolor{red}{красным}$ уже было сверху (также выделено $\textcolor{red}{красным}$), а значит:

$$
  S(x) \equiv \sum_{l = 1}^{t}{\left(\dfrac{E_lX_l^b}{1-X_lx}\right)}\operatorname{mod}x^{\delta - 1},
$$

то есть синдром сравним левой части по модулю $x^{\delta - 1}$.

Наконец, введем ещё один *многочлен значений ошибок* $\Gamma(x) = \displaystyle\sum_{l = 1}^{t}{\left(E_lX_l^b\textcolor{yellow}{\prod_{j \neq l}{\left(1-X_jx\right)}}\right)}$. Посмотрим повнимательнее на $\textcolor{yellow}{выделенное}$ и вспомним про *многочлен локаторов ошибок* $\Lambda(x) = \textcolor{yellow}{\prod_{l = 1}^{t}{\left(1 - X_lx\right)}}$. Сравним их по модулю $x^{\delta - 1}$ и получим:

$$
  \Gamma(x) = \displaystyle\sum_{l = 1}^{t}{\left(\textcolor{blue}{E_lX_l^b}\textcolor{yellow}{\prod_{j \neq l}{\left(1-X_jx\right)}}\right)} \equiv \textcolor{yellow}{\Lambda(x)}\sum_{l = 1}^{t}{\left(\dfrac{\textcolor{blue}{E_lX_l^b}}{1-X_lx}\right)}
$$

Внимательно посмотрим на *самый правую сумму* - это только что выраженный синдром $S(x)$:

$$
  \begin{cases}
    S(x) &\equiv \sum_{l = 1}^{t}{\left(\dfrac{E_lX_l^b}{1-X_lx}\right)}\operatorname{mod}x^{\delta - 1} \\
    \Gamma(x) &\equiv \Lambda(x) \sum_{l = 1}^{t}{\left(\dfrac{E_lX_l^b}{1-X_lx}\right)} \operatorname{mod}x^{\delta - 1}
  \end{cases} \implies \textcolor{brown}{\boxed{\Gamma(x) \equiv \Lambda(x)S(x) \operatorname{mod} x^{\delta - 1}}}
$$

То, что выделено - это и есть **ключевое уравнение декодирования кодов БЧХ**.

---

**Алгоритм Форни быстрого поиска значений ошибок**. Сложность: $\mathcal{O}(n^2)$.

$$
  E_i = \dfrac{X_i^{-b}\Gamma(X_i^{-1})}{\prod_{j\neq i}{\left(1 - X_jX_i^{-1}\right)}}, ~ 1 \leqslant i < t
$$

---

TODO про Евклида
